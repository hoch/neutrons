<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Beatboxing</title>
    <link rel="stylesheet" href="styles.css">
    <script src="slides.js" type="module"></script>
    <script type="module">
        import {Sequencer, Fragmentation} from "./modules/sequencing.js";

        function createUtterance(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 2.0;
            return utterance;
        }

        const utterances = [
            createUtterance("Boom"),
            createUtterance("g"),
            createUtterance("Tchuk"),
            createUtterance("j"),
        ];

        const pattern = [
            utterances[0], null, utterances[1], null,
            utterances[2], null, utterances[3], null,
        ];

        const synthesis = window.speechSynthesis;
        const sequencer = new Sequencer();
        const fragmentation = new Fragmentation((computeStartMillis, stepIndex, position, complete) => {
            const element = pattern[stepIndex % pattern.length];
            if (null !== element) {
                synthesis.cancel();
                synthesis.speak(element);
            }
        }, 1.0 / 16.0);
        sequencer.addProcessor((computeStartMillis, t0, t1) => fragmentation.equalise(computeStartMillis, t0, t1));
        sequencer.bpm.value = 90.0;
        sequencer.start();
    </script>
</head>
<body>
<header>
    <h1>Klangwerk</h1>
    <h2>Beatboxing</h2>
</header>
<article>

</article>
<footer></footer>
</body>
</html>